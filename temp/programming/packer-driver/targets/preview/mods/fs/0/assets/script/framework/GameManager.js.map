{"version":3,"sources":["file:///C:/Users/coderYarn/Desktop/airplane/assets/script/framework/GameManager.ts"],"names":["_decorator","Component","Node","Prefab","math","BoxCollider","macro","Label","Animation","Bullet","BulletProp","EnemyPlane","SelfPlane","AudioManager","Constant","PoolManager","ccclass","property","GameManager","Combination","PLAN1","BulletPropType","BULLET_M","start","_init","update","deltaTime","isGameStart","playerPlane","isDie","gameOver","_currShootTime","_isShooting","shootTime","_bulletType","BULLET_H","createPlayerBulletH","BULLET_S","createPlayerBulletS","createPlayerBulletM","name","playAudioEffect","_currCreateEnemyTime","_combinationInterval","createEnemyTime","createEnemyPlane","PLAN2","randomCombination","randomRangeInt","createCombination1","PLAN3","createCombination2","returnMain","node","setPosition","_score","gameStart","_changePlaneMode","gameScore","string","toString","init","gameReStart","gamePage","active","gameOverPage","gameOverScore","overAnim","play","unschedule","_modeChanged","_destroyAll","addScore","bullet","instance","getNode","bullet01","bulletRoot","pos","position","x","y","z","bulletComp","getComponent","show","bulletSpeed","bullet1","bullet03","bulletComp1","bullet2","bulletComp2","bullet05","Direction","LEFT","RIGHT","createEnemyBullet","targetPos","bullet02","colliderComp","setGroup","CollisionType","ENEMY_BULLET","setMask","SELF_PLANE","whichEnemy","prefab","speed","EnemyType","TYPE1","enemy01","enemy1Speed","enemy02","enemy2Speed","enemy","enemyComp","randomPos","enemyArray","Array","i","length","element","combinationPos","parent","startIndex","createEnemyEffect","effect","enemyExplode","createBulletProp","randomProp","bulletPropH","bulletPropS","bulletPropM","prop","propComp","bulletPropSpeed","isShooting","value","changeBulletType","type","audioEffect","schedule","REPEAT_FOREVER","children","child","putNode"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, Prefab, instantiate, math, Vec3, BoxCollider, macro, Label, Animation } from 'cc';\r\nimport { Bullet } from '../bullet/Bullet';\r\nimport { BulletProp } from '../bullet/BulletProp';\r\nimport { EnemyPlane } from '../plane/EnemyPlane';\r\nimport { SelfPlane } from '../plane/SelfPlane';\r\nimport { AudioManager } from './AudioManager';\r\nimport { Constant } from './Constant';\r\nimport { PoolManager } from './PoolManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = GameManager\r\n * DateTime = Mon Mar 13 2023 19:04:44 GMT+0800 (China Standard Time)\r\n * Author = mywayday\r\n * \r\n * FileBasename = GameManager.ts\r\n * FileBasenameNoExtension = GameManager\r\n * URL = db://assets/script/framework/GameManager.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n\r\n@ccclass('GameManager')\r\nexport class GameManager extends Component {\r\n    @property(SelfPlane)\r\n    public playerPlane: SelfPlane = null;\r\n    // bullet\r\n    @property(Prefab)\r\n    public bullet01: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet02: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet03: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet04: Prefab = null;\r\n    @property(Prefab)\r\n    public bullet05: Prefab = null;\r\n    @property\r\n    public shootTime = 0.3;\r\n    @property\r\n    public bulletSpeed = 1;\r\n    @property(Node)\r\n    public bulletRoot: Node = null;\r\n\r\n    // enemy\r\n    @property(Prefab)\r\n    public enemy01: Prefab = null;\r\n    @property(Prefab)\r\n    public enemy02: Prefab = null;\r\n    @property\r\n    public createEnemyTime = 1;\r\n    @property\r\n    public enemy1Speed = 0.5;\r\n    @property\r\n    public enemy2Speed = 0.7;\r\n    @property(Prefab)\r\n    public enemyExplode: Prefab = null;\r\n\r\n    // prop\r\n    @property(Prefab)\r\n    public bulletPropM: Prefab = null;\r\n    @property(Prefab)\r\n    public bulletPropH: Prefab = null;\r\n    @property(Prefab)\r\n    public bulletPropS: Prefab = null;\r\n    @property\r\n    public bulletPropSpeed = 0.3;\r\n\r\n    // ui\r\n    @property(Node)\r\n    public gamePage: Node = null;\r\n    @property(Node)\r\n    public gameOverPage: Node = null;\r\n    @property(Label)\r\n    public gameScore: Label = null;\r\n    @property(Label)\r\n    public gameOverScore: Label = null;\r\n    @property(Animation)\r\n    public overAnim: Animation = null;\r\n\r\n    // audio\r\n    @property(AudioManager)\r\n    public audioEffect: AudioManager = null;\r\n\r\n    public isGameStart = false;\r\n\r\n    private _currShootTime = 0;\r\n    private _isShooting = false;\r\n    private _currCreateEnemyTime = 0;\r\n    private _combinationInterval = Constant.Combination.PLAN1;\r\n    private _bulletType = Constant.BulletPropType.BULLET_M;\r\n    private _score = 0;\r\n\r\n\r\n    start () {\r\n        this._init();\r\n    }\r\n\r\n    update (deltaTime: number) {\r\n        if(!this.isGameStart){\r\n            return;\r\n        }\r\n\r\n        if(this.playerPlane.isDie){\r\n            this.gameOver();\r\n            return;\r\n        }\r\n\r\n        this._currShootTime += deltaTime;\r\n        if(this._isShooting && this._currShootTime > this.shootTime){\r\n            if (this._bulletType === Constant.BulletPropType.BULLET_H) {\r\n                this.createPlayerBulletH();\r\n            } else if (this._bulletType === Constant.BulletPropType.BULLET_S) {\r\n                this.createPlayerBulletS();\r\n            } else {\r\n                this.createPlayerBulletM();\r\n            }\r\n\r\n            const name = 'bullet' + (this._bulletType % 2 + 1);\r\n            this.playAudioEffect(name);\r\n            this._currShootTime = 0;\r\n        }\r\n\r\n        this._currCreateEnemyTime += deltaTime;\r\n        if(this._combinationInterval === Constant.Combination.PLAN1){\r\n            if(this._currCreateEnemyTime > this.createEnemyTime){\r\n                this.createEnemyPlane();\r\n                this._currCreateEnemyTime = 0;\r\n            }\r\n        } else if(this._combinationInterval === Constant.Combination.PLAN2){\r\n            if(this._currCreateEnemyTime > this.createEnemyTime * 3){\r\n                const randomCombination = math.randomRangeInt(1, 3);\r\n                if (randomCombination === Constant.Combination.PLAN2) {\r\n                    this.createCombination1();\r\n                } else {\r\n                    this.createEnemyPlane();\r\n                }\r\n\r\n                this._currCreateEnemyTime = 0;\r\n            }\r\n        } else {\r\n            if(this._currCreateEnemyTime > this.createEnemyTime * 2){\r\n                const randomCombination = math.randomRangeInt(1, 4);\r\n                if (randomCombination === Constant.Combination.PLAN2) {\r\n                    this.createCombination1();\r\n                } else if (randomCombination === Constant.Combination.PLAN3) {\r\n                    this.createCombination2();\r\n                } else {\r\n                    this.createEnemyPlane();\r\n                }\r\n\r\n                this._currCreateEnemyTime = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    public returnMain(){\r\n        this._currShootTime = 0;\r\n        this._currCreateEnemyTime = 0;\r\n        this._combinationInterval = Constant.Combination.PLAN1;\r\n        this._bulletType = Constant.BulletPropType.BULLET_M;\r\n        this.playerPlane.node.setPosition(0, 0, 15);\r\n        this._score = 0;\r\n    }\r\n\r\n    public gameStart(){\r\n        this.isGameStart = true;\r\n        this._changePlaneMode();\r\n        this._score = 0;\r\n        this.gameScore.string = this._score.toString();\r\n        this.playerPlane.init();\r\n    }\r\n\r\n    public gameReStart(){\r\n        this.gameStart();\r\n        this._currShootTime = 0;\r\n        this._currCreateEnemyTime = 0;\r\n        this._combinationInterval = Constant.Combination.PLAN1;\r\n        this._bulletType = Constant.BulletPropType.BULLET_M;\r\n        this.playerPlane.node.setPosition(0, 0, 15);\r\n    }\r\n\r\n    public gameOver(){\r\n        this.isGameStart = false;\r\n        this.gamePage.active = false;\r\n        this.gameOverPage.active = true;\r\n        this.gameOverScore.string = this._score.toString();\r\n        this.overAnim.play();\r\n        this._isShooting = false;\r\n        // this.playerPlane.init();\r\n        this.unschedule(this._modeChanged);\r\n        this._destroyAll();\r\n    }\r\n\r\n    public addScore(){\r\n        this._score ++;\r\n        this.gameScore.string = this._score.toString();\r\n    }\r\n\r\n    public createPlayerBulletM(){\r\n        const bullet = PoolManager.instance().getNode(this.bullet01, this.bulletRoot);\r\n        const pos = this.playerPlane.node.position;\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createPlayerBulletH(){\r\n        const pos = this.playerPlane.node.position;\r\n        // left\r\n        // const bullet1 = instantiate(this.bullet03);\r\n        const bullet1 = PoolManager.instance().getNode(this.bullet03, this.bulletRoot);\r\n        // bullet1.setParent(this.bulletRoot);\r\n        bullet1.setPosition(pos.x - 2.5, pos.y, pos.z - 7);\r\n        const bulletComp1 = bullet1.getComponent(Bullet);\r\n        bulletComp1.show(this.bulletSpeed, false);\r\n\r\n        // right\r\n        const bullet2 = PoolManager.instance().getNode(this.bullet03, this.bulletRoot);\r\n        // bullet2.setParent(this.bulletRoot);\r\n        bullet2.setPosition(pos.x + 2.5, pos.y, pos.z - 7);\r\n        const bulletComp2 = bullet2.getComponent(Bullet);\r\n        bulletComp2.show(this.bulletSpeed, false);\r\n    }\r\n\r\n    public createPlayerBulletS(){\r\n        const pos = this.playerPlane.node.position;\r\n        // middle\r\n        // const bullet = instantiate(this.bullet05);\r\n        const bullet = PoolManager.instance().getNode(this.bullet05, this.bulletRoot);\r\n        // bullet.setParent(this.bulletRoot);\r\n        bullet.setPosition(pos.x, pos.y, pos.z - 7);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(this.bulletSpeed, false);\r\n\r\n        // left\r\n        const bullet1 = PoolManager.instance().getNode(this.bullet05, this.bulletRoot);\r\n        // bullet1.setParent(this.bulletRoot);\r\n        bullet1.setPosition(pos.x - 4, pos.y, pos.z - 7);\r\n        const bulletComp1 = bullet1.getComponent(Bullet);\r\n        bulletComp1.show(this.bulletSpeed, false, Constant.Direction.LEFT);\r\n\r\n        // right\r\n        const bullet2 = PoolManager.instance().getNode(this.bullet05, this.bulletRoot);\r\n        // bullet2.setParent(this.bulletRoot);\r\n        bullet2.setPosition(pos.x + 4, pos.y, pos.z - 7);\r\n        const bulletComp2 = bullet2.getComponent(Bullet);\r\n        bulletComp2.show(this.bulletSpeed, false, Constant.Direction.RIGHT);\r\n    }\r\n\r\n    public createEnemyBullet(targetPos: Vec3){\r\n        // const bullet = instantiate(this.bullet01);\r\n        const bullet = PoolManager.instance().getNode(this.bullet02, this.bulletRoot);\r\n        // bullet.setParent(this.bulletRoot);\r\n        bullet.setPosition(targetPos.x, targetPos.y, targetPos.z + 6);\r\n        const bulletComp = bullet.getComponent(Bullet);\r\n        bulletComp.show(1, true);\r\n\r\n        const colliderComp = bullet.getComponent(BoxCollider);\r\n        colliderComp.setGroup(Constant.CollisionType.ENEMY_BULLET);\r\n        colliderComp.setMask(Constant.CollisionType.SELF_PLANE);\r\n    }\r\n\r\n    public createEnemyPlane(){\r\n        const whichEnemy = math.randomRangeInt(1, 3);\r\n        let prefab: Prefab = null;\r\n        let speed = 0;\r\n        if (whichEnemy === Constant.EnemyType.TYPE1) {\r\n            prefab = this.enemy01;\r\n            speed = this.enemy1Speed;\r\n        } else {\r\n            prefab = this.enemy02;\r\n            speed = this.enemy2Speed;\r\n        }\r\n\r\n        // const enemy = instantiate(prefab);\r\n        const enemy = PoolManager.instance().getNode(prefab, this.node);\r\n        // enemy.setParent(this.node);\r\n        const enemyComp = enemy.getComponent(EnemyPlane);\r\n        enemyComp.show(this, speed, true);\r\n\r\n        const randomPos = math.randomRangeInt(-25, 26);\r\n        enemy.setPosition(randomPos, 0, -50);\r\n    }\r\n\r\n    public createCombination1(){\r\n        const enemyArray = new Array<Node>(5);\r\n        for (let i = 0; i < enemyArray.length; i++) {\r\n            // enemyArray[i] = instantiate(this.enemy01);\r\n            enemyArray[i] = PoolManager.instance().getNode(this.enemy01,this.node );\r\n            const element = enemyArray[i];\r\n            // element.parent = this.node;\r\n            element.setPosition(-20 + i * 10, 0, -50);\r\n            const enemyComp = element.getComponent(EnemyPlane);\r\n            enemyComp.show(this, this.enemy1Speed, false);\r\n        }\r\n    }\r\n\r\n    public createCombination2(){\r\n        const enemyArray = new Array<Node>(7);\r\n\r\n        const combinationPos = [\r\n            -21, 0, -60,\r\n            -14, 0, -55,\r\n            -7, 0, -50,\r\n            0, 0, -45,\r\n            7, 0, -50,\r\n            14, 0, -55,\r\n            21, 0, -60,\r\n        ];\r\n\r\n        for (let i = 0; i < enemyArray.length; i++) {\r\n            enemyArray[i] = PoolManager.instance().getNode(this.enemy02, this.node);\r\n            // enemyArray[i] = instantiate(this.enemy02);\r\n            const element = enemyArray[i];\r\n            element.parent = this.node;\r\n            const startIndex = i * 3;\r\n            element.setPosition(combinationPos[startIndex], combinationPos[startIndex + 1], combinationPos[startIndex + 2]);\r\n            const enemyComp = element.getComponent(EnemyPlane);\r\n            enemyComp.show(this, this.enemy2Speed, false);\r\n        }\r\n    }\r\n\r\n    public createEnemyEffect(pos: Vec3){\r\n        const effect = PoolManager.instance().getNode(this.enemyExplode, this.node);\r\n        effect.setPosition(pos);\r\n    }\r\n\r\n    public createBulletProp(){\r\n        const randomProp = math.randomRangeInt(1, 4);\r\n        let prefab: Prefab = null;\r\n        if(randomProp === Constant.BulletPropType.BULLET_H){\r\n            prefab = this.bulletPropH;\r\n        } else if(randomProp === Constant.BulletPropType.BULLET_H){\r\n            prefab = this.bulletPropS;\r\n        } else {\r\n            prefab = this.bulletPropM;\r\n        }\r\n\r\n        // const prop = instantiate(prefab);\r\n        const prop = PoolManager.instance().getNode(prefab, this.node);\r\n        // prop.setParent(this.node);\r\n        prop.setPosition(15, 0, -50);\r\n        const propComp = prop.getComponent(BulletProp);\r\n        propComp.show(this, -this.bulletPropSpeed);\r\n    }\r\n\r\n    public isShooting(value: boolean){\r\n        this._isShooting = value;\r\n    }\r\n\r\n    public changeBulletType(type: number){\r\n        this._bulletType = type;\r\n    }\r\n\r\n    public playAudioEffect(name: string){\r\n        this.audioEffect.play(name);\r\n    }\r\n\r\n    private _init(){\r\n        this._currShootTime = this.shootTime;\r\n        this.playerPlane.init();\r\n    }\r\n\r\n    private _changePlaneMode(){\r\n        this.schedule(this._modeChanged, 10, macro.REPEAT_FOREVER);\r\n    }\r\n\r\n    private _modeChanged(){\r\n        this._combinationInterval ++;\r\n        this.createBulletProp();\r\n    }\r\n\r\n    private _destroyAll(){\r\n        let children = this.node.children;\r\n        let length = children.length;\r\n        let i = 0;\r\n        for ( i = length - 1; i >= 0 ; i--) {\r\n            const child = children[i];\r\n            PoolManager.instance().putNode(child);\r\n            // child.destroy();\r\n        }\r\n\r\n        children = this.bulletRoot.children;\r\n        length = children.length;\r\n        for (i = length - 1; i >= 0 ; i--) {\r\n            const child = children[i];\r\n            PoolManager.instance().putNode(child);\r\n            // child.destroy();\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}