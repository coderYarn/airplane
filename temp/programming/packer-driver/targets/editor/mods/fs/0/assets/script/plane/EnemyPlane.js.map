{"version":3,"sources":["file:///C:/Users/coderYarn/Desktop/airplane/assets/script/plane/EnemyPlane.ts"],"names":["_decorator","Component","Collider","Constant","PoolManager","ccclass","property","OUTOFBOUNCE","EnemyPlane","onEnable","collider","getComponent","on","_onTriggerEnter","onDisable","off","update","deltaTime","pos","node","position","movePos","z","_enemySpeed","setPosition","x","y","_needBullet","_currCreateBulletTime","createBulletTime","_gameManager","createEnemyBullet","instance","putNode","show","gameManager","speed","needBullet","event","collisionGroup","otherCollider","getGroup","CollisionType","SELF_PLANE","SELF_BULLET","playAudioEffect","addScore","createEnemyEffect"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAoCC,MAAAA,Q,OAAAA,Q;;AAChDC,MAAAA,Q,iBAAAA,Q;;AAEAC,MAAAA,W,iBAAAA,W;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEMO,MAAAA,W,GAAc,E;;4BAGPC,U,WADZH,OAAO,CAAC,YAAD,C,oCAAR,MACaG,UADb,SACgCP,SADhC,CAC0C;AAAA;AAAA;;AAAA;;AAAA,+CAIhB,CAJgB;;AAAA,+CAKhB,KALgB;;AAAA,gDAMF,IANE;;AAAA,yDAQN,CARM;AAAA;;AAUtCQ,QAAAA,QAAQ,GAAI;AACR,gBAAMC,QAAQ,GAAG,KAAKC,YAAL,CAAkBT,QAAlB,CAAjB;AACAQ,UAAAA,QAAQ,CAACE,EAAT,CAAY,gBAAZ,EAA8B,KAAKC,eAAnC,EAAoD,IAApD;AACH;;AAEDC,QAAAA,SAAS,GAAI;AACT,gBAAMJ,QAAQ,GAAG,KAAKC,YAAL,CAAkBT,QAAlB,CAAjB;AACAQ,UAAAA,QAAQ,CAACK,GAAT,CAAa,gBAAb,EAA+B,KAAKF,eAApC,EAAqD,IAArD;AACH;;AAEDG,QAAAA,MAAM,CAAEC,SAAF,EAAqB;AACvB,gBAAMC,GAAG,GAAG,KAAKC,IAAL,CAAUC,QAAtB;AACA,gBAAMC,OAAO,GAAGH,GAAG,CAACI,CAAJ,GAAQ,KAAKC,WAA7B;AACA,eAAKJ,IAAL,CAAUK,WAAV,CAAsBN,GAAG,CAACO,CAA1B,EAA6BP,GAAG,CAACQ,CAAjC,EAAoCL,OAApC;;AAEA,cAAG,KAAKM,WAAR,EAAoB;AAChB,iBAAKC,qBAAL,IAA8BX,SAA9B;;AACA,gBAAG,KAAKW,qBAAL,GAA6B,KAAKC,gBAArC,EAAsD;AAClD,mBAAKC,YAAL,CAAkBC,iBAAlB,CAAoC,KAAKZ,IAAL,CAAUC,QAA9C;;AACA,mBAAKQ,qBAAL,GAA6B,CAA7B;AACH;AACJ;;AAED,cAAGP,OAAO,GAAGd,WAAb,EAAyB;AACrB;AAAA;AAAA,4CAAYyB,QAAZ,GAAuBC,OAAvB,CAA+B,KAAKd,IAApC,EADqB,CAErB;AACH;AACJ;;AAEDe,QAAAA,IAAI,CAACC,WAAD,EAA2BC,KAA3B,EAA0CC,UAA1C,EAA8D;AAC9D,eAAKP,YAAL,GAAoBK,WAApB;AACA,eAAKZ,WAAL,GAAmBa,KAAnB;AACA,eAAKT,WAAL,GAAmBU,UAAnB;AACH;;AAEOxB,QAAAA,eAAe,CAACyB,KAAD,EAAsB;AACzC,gBAAMC,cAAc,GAAGD,KAAK,CAACE,aAAN,CAAoBC,QAApB,EAAvB;;AACA,cAAGF,cAAc,KAAK;AAAA;AAAA,oCAASG,aAAT,CAAuBC,UAA1C,IAAwDJ,cAAc,KAAK;AAAA;AAAA,oCAASG,aAAT,CAAuBE,WAArG,EAAiH;AAC7G;AACA,iBAAKd,YAAL,CAAkBe,eAAlB,CAAkC,OAAlC;;AACA;AAAA;AAAA,4CAAYb,QAAZ,GAAuBC,OAAvB,CAA+B,KAAKd,IAApC,EAH6G,CAI7G;;AACA,iBAAKW,YAAL,CAAkBgB,QAAlB;;AACA,iBAAKhB,YAAL,CAAkBiB,iBAAlB,CAAoC,KAAK5B,IAAL,CAAUC,QAA9C;AACH;AACJ;;AAvDqC,O,2FACrCd,Q;;;;;iBACyB,G;;;AAwD9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["\r\nimport { _decorator, Component, Node, sp, ITriggerEvent, Collider } from 'cc';\r\nimport { Constant } from '../framework/Constant';\r\nimport { GameManager } from '../framework/GameManager';\r\nimport { PoolManager } from '../framework/PoolManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Predefined variables\r\n * Name = EnemyPlane\r\n * DateTime = Mon Mar 13 2023 11:34:11 GMT+0800 (China Standard Time)\r\n * Author = mywayday\r\n * FileBasename = EnemyPlane.ts\r\n * FileBasenameNoExtension = EnemyPlane\r\n * URL = db://assets/script/plane/EnemyPlane.ts\r\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/en/\r\n *\r\n */\r\n\r\nconst OUTOFBOUNCE = 50;\r\n\r\n@ccclass('EnemyPlane')\r\nexport class EnemyPlane extends Component {\r\n    @property\r\n    public createBulletTime = 0.5;\r\n\r\n    private _enemySpeed = 0;\r\n    private _needBullet = false;\r\n    private _gameManager: GameManager = null;\r\n\r\n    private _currCreateBulletTime = 0;\r\n\r\n    onEnable () {\r\n        const collider = this.getComponent(Collider);\r\n        collider.on('onTriggerEnter', this._onTriggerEnter, this);\r\n    }\r\n\r\n    onDisable () {\r\n        const collider = this.getComponent(Collider);\r\n        collider.off('onTriggerEnter', this._onTriggerEnter, this);\r\n    }\r\n\r\n    update (deltaTime: number) {\r\n        const pos = this.node.position;\r\n        const movePos = pos.z + this._enemySpeed;\r\n        this.node.setPosition(pos.x, pos.y, movePos);\r\n\r\n        if(this._needBullet){\r\n            this._currCreateBulletTime += deltaTime;\r\n            if(this._currCreateBulletTime > this.createBulletTime){\r\n                this._gameManager.createEnemyBullet(this.node.position);\r\n                this._currCreateBulletTime = 0;\r\n            }\r\n        }\r\n\r\n        if(movePos > OUTOFBOUNCE){\r\n            PoolManager.instance().putNode(this.node);\r\n            // this.node.destroy();\r\n        }\r\n    }\r\n\r\n    show(gameManager: GameManager, speed: number, needBullet: boolean){\r\n        this._gameManager = gameManager;\r\n        this._enemySpeed = speed;\r\n        this._needBullet = needBullet;\r\n    }\r\n\r\n    private _onTriggerEnter(event: ITriggerEvent){\r\n        const collisionGroup = event.otherCollider.getGroup();\r\n        if(collisionGroup === Constant.CollisionType.SELF_PLANE || collisionGroup === Constant.CollisionType.SELF_BULLET){\r\n            // console.log('trigger enemy destroy');\r\n            this._gameManager.playAudioEffect('enemy');\r\n            PoolManager.instance().putNode(this.node);\r\n            // this.node.destroy();\r\n            this._gameManager.addScore();\r\n            this._gameManager.createEnemyEffect(this.node.position);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}